{
    "contents" : "---\ntitle: \"Xu_Hong_solutions_HW3\"\nauthor: \"Hong Xu\"\ndate: \"September 17, 2015\"\noutput: \n  pdf_document:\n      includes:\n          in_header: multisymbols.sty\n---\n\n## 1. \nProve that the total variance of $\\bX$ is the MSE of the mean:\n$$E|| \\bX - E(\\bX) ||^2 = \\tr(\\var(\\bX)).$$ \n\nProof:\n\nWe can show that the MSE of the mean:  $E|| \\bX - E(\\bX) ||^2 = E(\\sum_i (X_i - E(X_i))^2) = \\sum_i E((X_i - E(X_i))^2)$\n\nThe covariance of $\\bX$: $\\var(\\bX) = E((\\bX - E(\\bX))(\\bX - E(\\bX))^T)$\n\nSo the total variance of $\\bX$ equals to $\\tr(\\var(\\bX)) = \\sum_i E((X_i - E(X_i))(X_i - E(X_i))^T) = \\sum_i E((X_i - E(X_i))^2)$, which equals to the MSE of the mean.\n\n## 2.\nSuppose $\\bY \\sim N_n (0 ,I)$ and let $A$ be symmetric. Show that $$\\bY^TA\\bY \\stackrel{dist} {=}\\sum_i \\lambda_i W_i,$$ where \n$W_i \\stackrel{iid}{\\sim} \\chi_1^2$ and $\\lambda_1,\\ldots,\\lambda_n$ are the eigenvalues of $A.$\n\nProof:\n\nSince A is symmetric, we have the spectral decomposition of $A = PDP^T$,\n\nwhere $P$ is orthogonal, $D$ is a diagonal matrix diag($\\lambda_1,\\ldots,\\lambda_n$)\n\nSo $\\bY^TA\\bY = \\bY^TPDP^T\\bY = (P^T\\bY)^TD(P^T\\bY)$\n\nand $P^T\\bY \\sim N_n (P^T0, P^TIP)$, since $P$ is orthogonal, we have $P^T\\bY \\sim N_n (0, I)$.\n\nWith that, we can show $\\bY^TA\\bY = \\bY^TD\\bY = \\sum_i \\sum_j \\lambda_{ij} Y_i Y_j = \\sum_i \\lambda_i Y_i^2$.\n\nAnd $\\bY \\sim N_n (0 ,I)$, \n\nSo, $Y_i \\sim N_n (0, 1)$, $W_i = Y_i^2 \\sim \\chi_1^2$.\n\nSo that $\\bY^TA\\bY \\stackrel{dist} {=}\\sum_i \\lambda_i W_i.$\n\n\n## 3.\n### a) \n\nShow that this model implies that there is a positive covariance for within-state poverty rates over time, $\\Cov{Y_{i1}, Y_{i 2}} = \\Var{U_i} = \\sigma^2_u$.\n\nProof:\n\nSince $U_i \\stackrel{iid}{\\sim} \\mathcal{N}(0,\\sigma^2_u)$ and \n$\\epsilon_{it} \\stackrel{ind}{\\sim}\\mathcal{N}(0,\\sigma^2_{e_t})$, \n\nand $Y_{it} = \\mu_t + U_{i} + \\epsilon_{it}$,\n\nThen, at time t, $E(Y_{it}) = \\mu_t + E(U_i) + E(\\epsilon_{it}) = \\mu_t + 0 + 0 = \\mu_t$.\n\nSo, $\\Cov{Y_{i1}, Y_{i 2}} = E((Y_{i1} - E(Y_{i1}))(Y_{i2} - E(Y_{i2}))) = E((Y_{i1} - \\mu_1)(Y_{i2} - \\mu_2)) =$\n$E((U_i + \\epsilon_{i1})(U_i + \\epsilon_{i2})) = E(U_i^2 + \\epsilon_{i1}U_i + \\epsilon_{i2}U_i + \\epsilon_{i1}\\epsilon_{i2})$\n$= E(U_i^2) + E(\\epsilon_{i1}U_i) + E(\\epsilon_{i2}U_i) + E(\\epsilon_{i1}\\epsilon_{i2})$.\n\nSince $U_i$ and $\\epsilon_{it}$  are independent, it's easy to show the last three expecations are zero. So, $\\Cov{Y_{i1}, Y_{i 2}} = E(U_i^2)$\n\nAlso, $\\var(U_i) = E(U_i^2) - E(U_i)^2 = E(U_i^2)$,\n\nSo we have $\\Cov{Y_{i1}, Y_{i2}} = E(U_i^2) = \\var(U_i) = \\sigma^2_\\mu$\n\n\n### b)\n\nAnswer:\n\nSince $Y_{it} = \\mu_t + U_{i} + \\epsilon_{it}$,\n\n$Y_{it} \\sim N (\\mu_t, \\sigma^2_\\mu + \\sigma^2_{e_t})$.\n\nObviously $Y_{i1}$ and $Y_{i2}$ follow normaal distribution, so that $\\mathbf{Y}_i = (Y_{i1}, Y_{i2})^T$ would be an $\\mathcal{MVN}$ distribution.\n\nIts mean vector $\\mu$ would be $E(\\bY_i) =  (E(Y_{i1}), E(Y_{i2}))^T = (\\mu_1, \\mu_2)^T$, given the proof we showed in (a).\n\nIts $\\Sigma$ would be: \n$$\\mathbf{\\Sigma} = \\left[\\begin{array}\n{rrr}\n\\var(Y_{i1}) & \\cov(Y_{i1}, Y_{i2}) \\\\\n\\cov(Y_{i2}, Y_{i1}) & \\var(Y_{i2})\n\\end{array}\\right]\n$$\nGiven the proof in a) $\\Cov{Y_{i1}, Y_{i2}} = E(U_i^2) = \\var(U_i) = \\sigma^2_\\mu$, \n$$\\mathbf{\\Sigma} = \\left[\\begin{array}\n{rrr}\n\\sigma^2_\\mu + \\sigma^2_{e_1} & \\sigma^2_\\mu \\\\\n\\sigma^2_\\mu & \\sigma^2_\\mu + \\sigma^2_{e_2}\n\\end{array}\\right]\n$$\n\n### c)\n```{r}\n# skip the first row\nsaipe98 <- read.csv(\"CPS98T.TXT\", skip = 1, sep=\"\")\nsaipe05 <- read.csv(\"CPS05T.TXT\", skip = 1, sep=\"\")\n# for children aged 5-17, CPS poverty is at column cps98.1 or cps05.1\ncps98 <- saipe98[, \"cps98.1\"]\ncps05 <- saipe05[, \"cps05.1\"]\n# construct a data frame \ncps <- cbind(cps98, cps05)\n```\n\n### d)\n```{r}\n## find the mean poverty rate \ncolMeans(cps)\n```\n\n### e)\n```{r}\n## find the covariance matrix for Y, i.e. cps\ncov(cps)\n```\n\n### f)\nIn b) we showed:\n$$\\mathbf{\\Sigma} = \\left[\\begin{array}\n{rrr}\n\\sigma^2_\\mu + \\sigma^2_{e_1} & \\sigma^2_\\mu \\\\\n\\sigma^2_\\mu & \\sigma^2_\\mu + \\sigma^2_{e_2}\n\\end{array}\\right]\n$$\nand\n$$\n\\mu = (\\mu_1, \\mu_2)^T\n$$\nSo,\n\n$\\mu_1 = 16.97407$\n\n$\\mu_2 = 15.69192$\n\n$\\sigma^2_\\mu = 27.59969$\n\n$\\sigma^2_{e_1} = 39.92843 - \\sigma^2_\\mu = 39.92843 - 27.59969 = 12.32874$\n\n$\\sigma^2_{e_2} = 39.92843 - \\sigma^2_\\mu = 33.05264 - 27.59969 = 5.45295$\n\n\n\n### g)\n```{r}\nrequire(mvtnorm)\nx.points <- seq(0, 35, length.out = 100)\ny.points <- x.points\nz <- matrix(0, 100, 100)\nmu <- colMeans(cps)\nsigma <- cov(cps)\n\nfor (i in 1:100) {\n  for (j in 1:100) {\n    z[i, j] <- dmvnorm(c(x.points[i], y.points[j]), mean = mu, sigma = sigma)\n  }\n}\ncontour(x.points, y.points, z)\n# add points\npoints(cps[,1], cps[,2])\n\n## The multivariate normal looks like a good fit to the data\n## given the density and the rotation the data points appear.\n```\n\n\n",
    "created" : 1442523961989.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1387161812",
    "id" : "F2DE76AF",
    "lastKnownWriteTime" : 1442616903,
    "path" : "~/Documents/Duke/Term 3/sta 521/hw3/Hong_Xu_Solutions_HW3.Rmd",
    "project_path" : "Hong_Xu_Solutions_HW3.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}